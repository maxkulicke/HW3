<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="assets/css/style.css">
  <title>Random Password Generator</title>
</head>

<body>

  <nav class="navbar navbar-light bg-light">
    <span class="navbar-brand mb-0 h1">Max's Random Password Generator</span>
  </nav>
  <div class="container-fluid">
    <div class="row">
    </div>
    <div class="row">
      <div class="col-md-2">
      </div>
      <div class="col-md-8">
        <!-- modal -->
        <div class="modal fade" id="myModal" role="dialog">
          <div class="modal-dialog modal-dialog-centered">
            <!-- card -->
            <div class="modal-content">
              <div class="card">
                <div class="card-body">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h5 class="card-title">Random Password Generator</h5>
                  <h6 class="card-subtitle mb-2 text-muted">Select your password criteria below</h6>
                  <p class="card-text">
                    <!-- form -->
                    <form>
                      <div class="form">
                        <label for="formGroupExampleInput">Select password length (between 8 - 120 characters):</label>
                        <input type="text" class="form-control" id="passwordLengthInput" placeholder="required">
                      </div>
                    </form>
                    <!-- special characters -->
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="" id="specialCharactersCheck">
                      <label class="form-check-label" for="defaultCheck1">
                        Special Characters: !#$%&'()*+,-./:;<=>?@[]^_`{|}~
                      </label>
                    </div>
                    <!-- numeric characters -->
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="" id="numericCharactersCheck">
                      <label class="form-check-label" for="defaultCheck1">
                        Numbers: 0123456789
                      </label>
                    </div>
                    <!-- lowercase letters -->
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="" id="lowercaseLettersCheck">
                      <label class="form-check-label" for="defaultCheck1">
                        Lowercase Letters: abcdefghijklmnopqrstuvwxyz
                      </label>
                    </div>
                    <!-- uppercase letters -->
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" value="" id="uppercaseLettersCheck">
                      <label class="form-check-label" for="defaultCheck1">
                        Uppercase Letters: ABCDEFGHIJKLMNOPQRSTUVWXYZ
                      </label>
                    </div>
                </div>
                </p>
                <!-- this button will trigger script -->
                <!-- trigger popover? -->
                <button type="button" class="btn btn-dark" onclick="governor(20, true, true, true, true)">Generate Password</button>
                <a href="#" class="card-link">Generate Password</a>
                <!-- TODO: button for clipboard should be disabled until password generated -->
                <button type="button" class="btn btn-dark">Copy to Clipboard</button>
                <a href="#" class="card-link">Copy to Clipboard</a>
              </div>
            </div>
          </div>
        </div>
        <!-- TODO: Generate button should trigger modal and the generation script -->
        <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#myModal">Click To Begin</button>
      </div>
    </div>
  </div>
  <div class="col-md-2">
  </div>

  <script>

    // four character set strings
    var specialChars = "!#$%&'()*+,-./:;<=>?@[]^_`{|}~";
    // numericChars is tripled because of statistical underrepresentation during random selection
    // helps to reduce invalid password returns from randomizer
    var numericChars = "012345678901234567890123456789";
    var lowerChars = "abcdefghijklmnopqrstuvwxyz";
    var upperChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

    // PROMPTS/CONFIRMS
    // alert("Please complete the following forms to generate your random password");
    // // form input needs to validate numeric value between 8 - 120
    // var length = prompt("How long would you like your password to be? (passwords must be between 8 and 120 characters)");
    // alert("You will be asked to select which character sets your password will include");
    // alert("You must select at least one of the following four character sets: special characters, numbers, lowercase letters, uppercase letters");
    // // form input needs to validate that at least one charSet is selected
    // var special = confirm("Would you like to include special characters?");
    // var numeric = confirm("Would you like to include numbers?");
    // var lower = confirm("Would you like to include lowercase letters?");
    // var upper = confirm("Would you like to include uppercase letters?");
    // var criteria = objectMaker(length, special, numeric, lower, upper);
    // var password = generator(criteria);
    // alert("Your random password is: " + password);

    // governor runs the show
    function governor(length, special, numeric, lower, upper) {
      var criteria = objectMaker(length, special, numeric, lower, upper);
      var password = generator(criteria);
      console.log(password);
      return password;
    }

    // object maker function
    function objectMaker(length, special, numeric, lower, upper) {
      var criteria = {
        length: length,
        special: special,
        numeric: numeric,
        lower: lower,
        upper: upper,
      }
      return criteria;
    }

    // generator function
    function generator(criteriaObject) {
      // will generate array from criteriaObject
      var criteriaArray = arrayMaker(criteriaObject);
      // will call stringMaker
      var charList = stringMaker(criteriaArray);
      // will call randomizer
      var password = randomizer(criteriaArray, charList);
      // !!! if "invalid password" call randomizer again !!!!
      while (password === "invalid") {
        console.log("invalid password encountered");
        password = randomizer(criteriaArray, charList);
      }
      // will return password
      return password;
    }

    // arrayMaker function
    function arrayMaker(criteriaObject) {
      var criteriaArray = [criteriaObject.length, criteriaObject.special,
      criteriaObject.numeric, criteriaObject.lower, criteriaObject.upper];
      return criteriaArray;
    }

    // stringMaker function
    function stringMaker(arr) {
      var charList = "";
      for (var i = 1; i < arr.length; i++) {
        if (arr[i]) {
          if (i === 1) {
            charList = charList.concat(specialChars);
          }
          else if (i === 2) {
            charList = charList.concat(numericChars);
          }
          else if (i === 3) {
            charList = charList.concat(lowerChars);
          }
          else if (i === 4) {
            charList = charList.concat(upperChars);
          }
        }
      }
      return charList;
    }

    // randomizer function
    function randomizer(arr, charList) {
      var password = "";
      for (var i = 0; i < arr[0]; i++) {
        var nextChar = charList.charAt(Math.floor(charList.length * Math.random()));
        password = password.concat(nextChar);
      }
      password = validator(arr, password, charList);
      return password;
    }

    // validator function
    // could this be more DRY? !!!!!
    // tricky little function
    // takes in the array of user inputs created by generator function
    // and the generated password from randomizer
    // and validates that it contains a character from each eligible
    // character list. if valid, it returns the input password,
    // if invalid, it returns string "invalid password", which will
    // trigger a restart of the process in a different function
    function validator(arr, password, charList) {
      var valid = true;
      for (var i = 1; i < arr.length; i++) {
        if (arr[i]) {
          if (i === 1) {
            valid = contains(password, specialChars);
            if (!valid) {
              i = arr.length;
            }
          }
          else if (i === 2) {
            valid = contains(password, numericChars);
            if (!valid) {
              i = arr.length;
            }
          }
          else if (i === 3) {
            valid = contains(password, lowerChars);
            if (!valid) {
              i = arr.length;
            }
          }
          else if (i === 4) {
            valid = contains(password, upperChars);
            if (!valid) {
              i = arr.length;
            }
          }
        }
      }
      if (valid) {
        return password;
      }
      else {
        var invalid = "invalid";
        return invalid;
      }
    }

    // contains function
    // checks to make sure password string (password) includes at least 
    // 1 character from character set (charString), returns boolean (valid)
    function contains(password, charString) {
      var valid = false;
      for (var i = 0; i < charString.length; i++) {
        valid = password.includes(charString.charAt(i));
        if (valid) {
          i = charString.length;
        }
      }
      return valid;
    }


  </script>


  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>

</body>

</html>